### 1. 核心技術目標：實現「三位一體」的 Agent

我們將目標拆解為三個核心維度，確保你的 Ralph Loop 既強大又可控：

* **自主迭代 (The Infinite Loop)**：
* 利用 **Golang** 建立一個常駐程式（Daemon-like），不斷循環「接收任務 -> 生成代碼/指令 -> 執行 -> 讀取報錯 -> 修正」的過程。
* 目標是讓 AI 能夠在沒有人為干預的情況下，自主處理專案中的 Lint 錯誤、單元測試失敗或功能重構。


* **智能銜接 (SDK Integration)**：
* 透過 **Copilot SDK**（或封裝後的 API）獲取模型能力。
* **關鍵技術**：精準定義 `Completion Premise`（前提指令），賦予模型「系統觀察者」的身分，而不僅僅是代碼生成器。


* **絕對安全性 (The Iron Shield)**：
* 建立一套**「非黑即白」的指令過濾系統**，確保無論 AI 如何思考，都無法執行任何具備破壞性的檔案刪除指令（如 `rm`, `del`, `rd`）。
* 防禦範圍需涵蓋 **Windows CMD/PowerShell** 以及 **WSL (Linux)** 兩套系統環境。



---

### 2. 實作階段規劃（Roadmap）

| 階段 | 任務重點 | 技術手段 |
| --- | --- | --- |
| **第一階段：通訊層** | 成功橋接 Copilot 模型 | Golang 調用 SDK 接口，實現 Context（上下文）的傳遞。 |
| **第二階段：狀態機** | 建立 Ralph Loop 邏輯 | 實作 `Observe-Reflect-Act` 循環，確保程式能讀取 PowerShell 輸出。 |
| **第三階段：安全層** | 攔截破壞性指令 | **指令過濾器 (Filter)**：過濾 `rm -rf`, `del /s` 等字串；實作白名單機制。 |
| **第四階段：沙盒化** | 權限最小化 | 建立受限的 Windows 使用者，限制 Loop 只能改動特定目錄。 |
| **第五階段：持久化** | 三天三夜穩定運行 | 將執行日誌寫入 `.json` 檔案，支援斷電重啟後從上次狀態繼續。 |

---

### 3. 安全性守則 (Security Guardrails)

這是你最關心的部分，我們的目標是達成以下「負責任的自動化」：

1. **關鍵字攔截**：
* **WSL/Linux**: 攔截 `rm`, `mv` (移到目錄外), `chmod`, `chown`, `> /dev/`。
* **Windows**: 攔截 `del`, `erase`, `rd`, `rmdir`, `format`, `net user`, `reg delete`。


2. **路徑限制**：
* 強制規定所有生成的指令路徑必須位於 `$ProjectRoot` 內。如果 AI 試圖操作 `C:\Windows` 或 `/etc/`，過濾器將直接中止該次迭代。


3. **行為監督**：
* 雖然目標是全自動，但在開發初期可設定一個「高風險預警」，當指令包含敏感關鍵字時，發送 Windows 通知提醒。



### 4. 預期成果

完成後，你將擁有一款專屬於自己的 **CLI 機器人**。你只需在 VS Code 裡輸入一個目標（例如：「把這 50 個 Go 檔案的變數名稱從蛇形改為駝峰式，並修正所有報錯」），你就可以去睡覺，讓它在接下來的三天裡，安全地、不斷地幫你試錯與修正，直到程式碼完美運行。

**這就是你所追求的「無限可能」。我們接下來是否要從「指令過濾器」的 Golang 代碼實作開始細化？**